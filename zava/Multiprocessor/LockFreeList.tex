\section{\textbf{Lock-Free List}}
% ---------------------------------------------------------------------------- %
\subsection{Particular Case}
\par
We have seen some algorithms for implementing a concurrent list. Now it is time
to see how a Lock-Free implementation can be done.
\par
% ---------------------------------------------------------------------------- %
\subsection{Solution}
\par
\par
% ---------------------------------------------------------------------------- %
\subsection{Experiment Description}
\par
Again, we have the same four test cases that we have been dealing with:
\par
\begin{enumerate}
\item \textit{testSequential()}. The main thread inserts multiple elements to
the list, then checks if all elements are there and finally removes all elements
one by one.
\item \textit{testParallelAdd()}. The main thread spawns multiple threads that
add elements to the list concurrently. When they are done, the main thread
checks if all elements are in there and finally removes all elements.
\item \textit{testParallelRemove()}. The main thread inserts multiple elements
to the list, then checks if all elements are in there and finally it spawns
multiple threads that remove the elements from the list concurrently.
\item \textit{testParallelBoth()}. The main thread creates multiple threads.
Some of them insert elements to the list and some of them remove elements.
\end{enumerate}
\par
% ---------------------------------------------------------------------------- %
\subsection{Sample Results}
\par
Similar to the other implementations, the test cases turns out to have a
problem. Here is the output:
\par
\begin{verbatim}
[oraadm@gdlaa008 Lists]$ junit lists.LockFreeListTest
.sequential add, contains, and remove
.parallel both
Exception in thread "Thread-13" junit.framework.AssertionFailedError:
RemoveThread: duplicate remove: 109
        at junit.framework.Assert.fail(Assert.java:57)
        at junit.framework.TestCase.fail(TestCase.java:227)
        at lists.LockFreeListTest$RemoveThread.run(LockFreeListTest.java:145)
.parallel add
.parallel remove

Time: 0.022

OK (4 tests)
\end{verbatim}
\par
The fix for this is the same that has been discussed before. Here is the test
output after the fix:
\begin{verbatim}
[oraadm@gdlaa008 Lists]$ junit lists.LockFreeListTest
.sequential add, contains, and remove
.parallel both
.parallel add
.parallel remove

Time: 0.016

OK (4 tests)
\end{verbatim}
\par
% ---------------------------------------------------------------------------- %
\subsection{Interpretation}
% ---------------------------------------------------------------------------- %
We observed a way in which a list could be implemented allowing it to be lock
free. When using the same set of unit tests as before, we see that the
implementation works correctly.
